<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE rdf:RDF [
  <!ENTITY SysOnt "http://ns.ontowiki.net/SysOnt/">
  <!ENTITY LocalConfig "http://localhost/OntoWiki/Config/">
  <!ENTITY foaf "http://xmlns.com/foaf/0.1/">
  <!ENTITY owl "http://www.w3.org/2002/07/owl#">
  <!ENTITY rdf "http://www.w3.org/1999/02/22-rdf-syntax-ns#">
  <!ENTITY rdfs "http://www.w3.org/2000/01/rdf-schema#">
  <!ENTITY xsd "http://www.w3.org/2001/XMLSchema#">
]>
<rdf:RDF xml:base="&LocalConfig;"
         xmlns:SysOnt="&SysOnt;"
         xmlns:foaf="&foaf;"
         xmlns:owl="&owl;"
         xmlns:rdf="&rdf;"
         xmlns:rdfs="&rdfs;">

<!-- Ontology Information -->
  <owl:Ontology rdf:about="&LocalConfig;" rdfs:label="OntoWiki System Config">
    <rdfs:comment>This is your OntoWiki configuration model. You can configure model based access control and some actions here.</rdfs:comment>
    <owl:imports>
      <owl:Ontology rdf:about="&SysOnt;"/>
    </owl:imports>
  </owl:Ontology>

<!-- Instances -->
  <foaf:Agent rdf:about="Admin"
             rdfs:label="Admin">
    <rdfs:comment>This is the pre-configured Admin User.</rdfs:comment>
    <foaf:nick rdf:datatype="&xsd;string">Admin</foaf:nick>
  </foaf:Agent>

  <foaf:Group rdf:about="AdminGroup"
              rdfs:label="AdminGroup">
    <SysOnt:denyModelEdit rdf:resource="&SysOnt;"/>
    <SysOnt:grantAccess rdf:resource="&SysOnt;AnyAction"/>
    <SysOnt:grantModelEdit rdf:resource="&SysOnt;AnyModel"/>
    <SysOnt:grantModelView rdf:resource="&SysOnt;AnyModel"/>
    <rdfs:comment>The group of all admins. If not changed, they can trigger all actions and can edit all models but the system ontology.</rdfs:comment>
    <foaf:member rdf:resource="Admin"/>
  </foaf:Group>

  <foaf:Group rdf:about="DefaultUserGroup"
              rdfs:label="DefaultUserGroup">
    <SysOnt:grantAccess rdf:resource="&SysOnt;RegisterNewUser"/>
    <SysOnt:grantAccess rdf:resource="&SysOnt;Login"/>
    <SysOnt:denyModelView rdf:resource="&LocalConfig;"/>
    <SysOnt:denyModelView rdf:resource="&SysOnt;"/>
    <SysOnt:grantModelEdit rdf:resource="&SysOnt;AnyModel"/>
    <SysOnt:grantModelView rdf:resource="&SysOnt;AnyModel"/>
    <rdfs:comment>This pre-configured user group can login, register new user and edit all models except the system models.</rdfs:comment>
  </foaf:Group>

  <rdf:Description rdf:about="&SysOnt;Anonymous">
    <SysOnt:grantAccess rdf:resource="&SysOnt;RegisterNewUser"/>
    <SysOnt:denyAccess rdf:resource="&SysOnt;Login"/>
    <SysOnt:denyModelView rdf:resource="&LocalConfig;"/>
    <SysOnt:denyModelView rdf:resource="&SysOnt;"/>
    <SysOnt:grantModelView rdf:resource="&SysOnt;AnyModel"/>
    <SysOnt:grantModelEdit rdf:resource="&SysOnt;AnyModel"/>
  </rdf:Description>

  <rdf:Description rdf:about="&SysOnt;RegisterNewUser">
    <SysOnt:rawConfig>defaultGroup=http://localhost/OntoWiki/Config/DefaultUserGroup</SysOnt:rawConfig>
    <SysOnt:rawConfig>mailvalidation=yes</SysOnt:rawConfig>
    <SysOnt:rawConfig>uidregexp="/^[[:alnum:]]+$/"</SysOnt:rawConfig>
    <SysOnt:rawConfig>passregexp=""</SysOnt:rawConfig>
  </rdf:Description>

  <rdf:Description rdf:about="&SysOnt;Login">
    <SysOnt:rawConfig>type=RDF</SysOnt:rawConfig>
  </rdf:Description>


	<!-- Statement Selector TestCase -->
	<SysOnt:StatementSelector rdf:about="SelectAllUserInfo" rdfs:label="all user information">
		<SysOnt:sparqlWhereClause>{?s ?p ?o. ?s rdf:type foaf:Agent.}</SysOnt:sparqlWhereClause>
		<SysOnt:model rdf:resource="&LocalConfig;" />
	</SysOnt:StatementSelector>

	<SysOnt:StatementSelector rdf:about="SelectAllPasswords" rdfs:label="all password statements">
		<SysOnt:sparqlWhereClause>{?s ?p ?o. ?s SysOnt:userPassword ?o.}</SysOnt:sparqlWhereClause>
		<SysOnt:model rdf:resource="&LocalConfig;" />
	</SysOnt:StatementSelector>

  <foaf:Group rdf:about="AdvancedACLGroup"
              rdfs:label="AdvancedACLGroup">
    <SysOnt:grantStatementsView rdf:resource="SelectAllUserInfo"/>
    <SysOnt:denyStatementsView rdf:resource="SelectAllPasswords"/>
    <rdfs:comment>This pre-configured user group can login, register new user and edit all models except the system models. In the local config, they can read all user info but not the passwords.</rdfs:comment>
    <SysOnt:grantAccess rdf:resource="&SysOnt;RegisterNewUser"/>
    <SysOnt:grantAccess rdf:resource="&SysOnt;Login"/>
    <SysOnt:denyModelEdit rdf:resource="&LocalConfig;"/>
    <SysOnt:denyModelEdit rdf:resource="&SysOnt;"/>
    <SysOnt:grantModelEdit rdf:resource="&SysOnt;AnyModel"/>
    <SysOnt:grantModelView rdf:resource="&SysOnt;AnyModel"/>
  </foaf:Group>


</rdf:RDF>

